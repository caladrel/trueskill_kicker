{% extends 'league/base_players.html' %}
{% block header %}
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/rickshaw/1.4.6/rickshaw.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/rickshaw/1.4.6/rickshaw.min.js"></script>
{% endblock %}
{% block content %}
<h1>Players</h1>
<ul class="nav nav-tabs">
    <li><a href="{% url 'league:players' %}">List</a></li>
    <li class="active"><a href="#">Top ten</a></li>
</ul>
<div class="panel panel-default">
    <div class="panel-heading">historical data</div>
    <div class="panel-body">
        <div id="dummy"></div>
        <div id="chart">
            <div id="legend" style="position:absolute;bottom: 10px;right:10px">
            </div>
        </div>
    </div>
</div>
<script>

var palette = new Rickshaw.Color.Palette({ scheme: 'classic9'});
var series = [
    {% for player in player_list %}
        { color: palette.color(), name: '{{ player.name }}', data: [
        {% for entry in player.history %}
        { x: {{ entry.match.timestamp| date:'U' }}, y: {{ entry.rank }} },
        {% endfor %}
        ]},
    {% endfor %}
    ];

var graph = new Rickshaw.Graph({
    element: document.querySelector("#chart"),
    renderer: 'line',
    series: series,
    padding: { top: 0.1, left: 0.05 },
    interpolation: 'bundle'
});

var x_axis = new Rickshaw.Graph.Axis.Time( { graph: graph } );
var y_axis = new Rickshaw.Graph.Axis.Y( { graph: graph } );
var legend = new Rickshaw.Graph.Legend( { graph: graph,
       element: document.querySelector("#legend") } );
var shelving = new Rickshaw.Graph.Behavior.Series.Toggle({
    graph: graph,
    legend: legend
});

var resize = function() {
    dummy = document.querySelector("#dummy");
    graph.configure({ width: chart.clientWidth, height: 600 });
	graph.render();
}

window.addEventListener('resize', resize);
resize();
</script>
<ul class="nav nav-pills">
    <li>
    <a href="{% url 'league:players' %}">Back to player overview</a>
    </li>
</ul>
{% endblock %}
